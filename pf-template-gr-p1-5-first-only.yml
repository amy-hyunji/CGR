# The name of experiment
experiment: contextualized-GENRE-gr-p1-5-first-only

# The name of job
name: contextualized-GENRE-gr-p1-5-first-only

# The name of vm type
vm: azure-16gb-v100-1g-eastus-spot 

# The number of GPU devices
num_devices: 1

# Configure your job!
job_setting:
  type: custom

  # Docker config
  docker:
    # Docker image you want to use in the job
    image: friendliai/periflow:sdk
    # Bash shell command to run the job
    # NOTE: PeriFlow automatically sets the following environment variables for PyTorch DDP.
    #   - MASTER_ADDR: Address of rank 0 node.
    #   - WORLD_SIZE: The total number of GPUs participating in the task.
    #   - NODE_RANK: Index of the current node.
    #   - NPROC_PER_NODE: The number of processes in the current node.
    command: >
      cd /workspace/t_src && pip install -r requirements.txt && cd transformers && pip install -e . && cd ../ && python train.py --config config/periflow/gr/nq_toy_bi_p1-5_first_only.json
  
  # Path to mount your workspace volume
  workspace:
    mount_path: /workspace

# Checkpoint config
checkpoint:
  input:
      id: 90a971f0-abde-44d8-9013-fd35065a8cc6
      mount_path: /workspace/ckpt
  # Path to output checkpoint
  output_checkpoint_dir: /workspace/ckpt

data:
   name: bi_p1-5_first_only 
   mount_path: /workspace/dataset

plugin:
   wandb: 
      credential_id: eee4eb41-2cfe-42fd-b55e-e9ace7ca0288 #edd7e4ba646b4766dd997806149e50cc6fba0906 
   slack:
      credential_id: 3d6158f4-2ba8-45c3-b33f-eef440bf13a5 #xoxb-1678060811558-2584137787015-XKvQ2KHLAm0otgusf1aunbCh 
      channel: U01P1QPCC9J
